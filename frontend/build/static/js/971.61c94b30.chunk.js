/*! For license information please see 971.61c94b30.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkdevassist_pro_frontend=self.webpackChunkdevassist_pro_frontend||[]).push([[971],{2971:(e,t,s)=>{s.r(t),s.d(t,{default:()=>H});var r=s(9950),a=s(8429),i=s(7557),o=s(9325),n=s(7637),l=s(9655);const c=(0,l.A)("PenTool",[["path",{d:"m12 19 7-7 3 3-7 7-3-3z",key:"rklqx2"}],["path",{d:"m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z",key:"1et58u"}],["path",{d:"m2 2 7.586 7.586",key:"etlp93"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);var d=s(6890),u=s(6274),h=s(3270),p=s(5553),m=s(5674),_=s(1064),g=s(2195);const E=(0,l.A)("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);var A=s(983),y=s(6987),T=s(5492),R=s(1900),f=s(4458),x=s(2966);s(374);const v=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.baseURL=void 0,this.timeout=void 0,this.retryAttempts=void 0,this.retryDelay=void 0,this.isRefreshing=!1,this.failedQueue=[];let t=e.baseURL||"/api";t.startsWith("http")&&!t.endsWith("/api")&&(t=t.replace(/\/+$/,"")+"/api"),this.baseURL=t,this.timeout=e.timeout||3e4,this.retryAttempts=e.retryAttempts||3,this.retryDelay=e.retryDelay||1e3,console.log("[HTTPInterceptor] Initialized with baseURL:",this.baseURL)}async request(e){const t=await this.requestInterceptor(e);try{const e=await this.performRequest(t);return await this.responseInterceptor(e,t)}catch(s){return await this.errorInterceptor(s,t)}}async requestInterceptor(e){var t;const s={...e};return s.headers={"Content-Type":"application/json",Accept:"application/json",...s.headers||{}},s.url.startsWith("http")||(s.url=`${this.baseURL}${s.url}`),!1!==s.requiresAuth&&await this.addAuthorizationHeader(s),console.log("[HTTPInterceptor] Outgoing request:",{method:s.method,url:s.url,baseURL:this.baseURL,originalUrl:e.url,hasAuth:!(null===(t=s.headers)||void 0===t||!t.Authorization),timestamp:(new Date).toISOString()}),s}async responseInterceptor(e,t){if(console.log("[HTTPInterceptor] Response received:",{status:e.status,url:t.url,method:t.method,timestamp:(new Date).toISOString()}),!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);return e.data}async errorInterceptor(e,t){const s=t;if(console.error("[HTTPInterceptor] Request failed:",{url:t.url,method:t.method,error:e.message,status:e.status,timestamp:(new Date).toISOString()}),401===e.status&&!1!==t.requiresAuth)return this.handle401Error(s);if(this.isNetworkError(e)&&(s.retryCount||0)<this.retryAttempts)return this.retryRequest(s);throw this.createAPIError(e,t)}async handle401Error(e){if(e.url.includes("/auth/refresh"))throw console.log("[HTTPInterceptor] Refresh token request failed, redirecting to login"),this.redirectToLogin(),new Error("Authentication failed");if(this.isRefreshing)return new Promise((t,s)=>{this.failedQueue.push({resolve:t,reject:s,config:e})});this.isRefreshing=!0;try{await x.L.refreshTokens(),console.log("[HTTPInterceptor] Token refreshed successfully, retrying failed requests"),this.processFailedQueue(null);const t=await this.requestInterceptor(e);return this.performRequest(t)}catch(t){throw console.error("[HTTPInterceptor] Token refresh failed:",t),this.processFailedQueue(t),this.redirectToLogin(),new Error("Authentication failed and token refresh unsuccessful")}finally{this.isRefreshing=!1}}processFailedQueue(e){this.failedQueue.forEach(t=>{let{resolve:s,reject:r,config:a}=t;e?r(e):s(this.request(a))}),this.failedQueue=[]}async retryRequest(e){const t=(e.retryCount||0)+1,s=this.retryDelay*Math.pow(2,t-1);console.log(`[HTTPInterceptor] Retrying request (attempt ${t}/${this.retryAttempts}) after ${s}ms`,{url:e.url,method:e.method}),await new Promise(e=>setTimeout(e,s));const r={...e,retryCount:t};return this.request(r)}async addAuthorizationHeader(e){{if(x.B.shouldRefreshToken()&&!x.B.isRefreshTokenExpired())try{await x.L.refreshTokens(),console.log("[HTTPInterceptor] Token refreshed proactively")}catch(t){console.warn("[HTTPInterceptor] Proactive token refresh failed:",t)}const s=x.B.getAuthorizationHeader();if(s)e.headers||(e.headers={}),e.headers.Authorization=s;else if(!1!==e.requiresAuth)throw console.warn("[HTTPInterceptor] No valid token available for authenticated request"),new Error("No valid authentication token available")}}async performRequest(e){const t=new AbortController,s=setTimeout(()=>t.abort(),this.timeout);try{const r={method:e.method,headers:e.headers,signal:t.signal,credentials:"include"};e.body&&["POST","PUT","PATCH"].includes(e.method.toUpperCase())&&(r.body="string"===typeof e.body?e.body:JSON.stringify(e.body));const a=await fetch(e.url,r);let i;clearTimeout(s);const o=a.headers.get("content-type");return i=o&&o.includes("application/json")?await a.json():await a.text(),{ok:a.ok,status:a.status,statusText:a.statusText,data:i,headers:a.headers}}catch(r){if(clearTimeout(s),"AbortError"===r.name)throw new Error(`Request timeout after ${this.timeout}ms`);throw r}}isNetworkError(e){return"TypeError"===e.name||"Failed to fetch"===e.message||e.message.includes("network")||"NETWORK_ERROR"===e.code}createAPIError(e,t){const s=new Error(e.message||"API request failed");return Object.assign(s,{status:null===e||void 0===e?void 0:e.status,statusText:null===e||void 0===e?void 0:e.statusText,url:t.url,method:t.method,timestamp:(new Date).toISOString()}),s}redirectToLogin(){if(x.B.clearTokens(),"undefined"!==typeof window){const e=window.location.pathname,t=`/auth/login?redirect=${encodeURIComponent(e)}`;window.location.href=t}}async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request({method:"GET",url:e,...t})}async post(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request({method:"POST",url:e,body:t,...s})}async put(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request({method:"PUT",url:e,body:t,...s})}async patch(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request({method:"PATCH",url:e,body:t,...s})}async delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request({method:"DELETE",url:e,...t})}}({baseURL:"http://46.149.71.162:8000",timeout:3e4,retryAttempts:3,retryDelay:1e3}),S={BASE_URL:"http://46.149.71.162:8000",USE_REAL_API:!0,ENDPOINTS:{UPLOAD:"/api/documents/upload",ANALYZE:"/api/documents",FULL_ANALYSIS:"/api/kp-analyzer/full-analysis",GENERATE_PDF_REPORT:"/api/reports/generate/pdf",GENERATE_EXCEL_REPORT:"/api/reports/generate/excel",ANALYTICS_PROCESS:"/api/analytics/process",ANALYTICS_DASHBOARD:"/api/analytics/dashboard",ANALYTICS_METRICS:"/api/analytics/metrics",HEALTH:"/health",ADMIN_STATUS:"/api/admin/status",ADMIN_STATS:"/api/admin/stats",USAGE_STATS:"/api/admin/stats",DASHBOARD_STATS:"/api/analytics/dashboard"},REQUEST:{TIMEOUT:12e4,UPLOAD_TIMEOUT:6e4,RETRY_ATTEMPTS:3,RETRY_DELAY:1e3},DEFAULT_HEADERS:{"Content-Type":"application/json",Accept:"application/json"},FILE_UPLOAD:{MAX_SIZE:parseInt({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_API_URL:"http://46.149.71.162:8000",REACT_APP_API_BASE_URL:"http://46.149.71.162:8000/api",REACT_APP_WS_URL:"ws://46.149.71.162:8000/ws",REACT_APP_ENVIRONMENT:"development",REACT_APP_USE_REAL_API:"true"}.REACT_APP_MAX_FILE_SIZE||"10485760"),SUPPORTED_FORMATS:({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_API_URL:"http://46.149.71.162:8000",REACT_APP_API_BASE_URL:"http://46.149.71.162:8000/api",REACT_APP_WS_URL:"ws://46.149.71.162:8000/ws",REACT_APP_ENVIRONMENT:"development",REACT_APP_USE_REAL_API:"true"}.REACT_APP_SUPPORTED_FORMATS||"pdf,docx,doc,txt").split(","),CHUNK_SIZE:1048576},AI_MODELS:{DEFAULT_ANALYSIS:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_API_URL:"http://46.149.71.162:8000",REACT_APP_API_BASE_URL:"http://46.149.71.162:8000/api",REACT_APP_WS_URL:"ws://46.149.71.162:8000/ws",REACT_APP_ENVIRONMENT:"development",REACT_APP_USE_REAL_API:"true"}.REACT_APP_DEFAULT_ANALYSIS_MODEL||"claude-3-5-sonnet-20240620",DEFAULT_COMPARISON:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_API_URL:"http://46.149.71.162:8000",REACT_APP_API_BASE_URL:"http://46.149.71.162:8000/api",REACT_APP_WS_URL:"ws://46.149.71.162:8000/ws",REACT_APP_ENVIRONMENT:"development",REACT_APP_USE_REAL_API:"true"}.REACT_APP_DEFAULT_COMPARISON_MODEL||"gpt-4o",AVAILABLE:{CLAUDE:["claude-3-5-sonnet-20240620","claude-3-sonnet-20240229","claude-3-opus-20240229"],OPENAI:["gpt-4o","gpt-4-turbo","gpt-4","gpt-3.5-turbo"]}},STREAMING:{ENABLED:"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_API_URL:"http://46.149.71.162:8000",REACT_APP_API_BASE_URL:"http://46.149.71.162:8000/api",REACT_APP_WS_URL:"ws://46.149.71.162:8000/ws",REACT_APP_ENVIRONMENT:"development",REACT_APP_USE_REAL_API:"true"}.REACT_APP_ENABLE_STREAMING,CHUNK_TIMEOUT:1e4,RECONNECT_ATTEMPTS:5},RATE_LIMIT:{REQUESTS_PER_MINUTE:30,ANALYSIS_PER_HOUR:50,FILE_UPLOADS_PER_HOUR:100}},P=(e,t)=>{let s=`${S.BASE_URL}${S.ENDPOINTS[e]}`;if(t){s+=`?${new URLSearchParams(t).toString()}`}return s};const N=new class{constructor(){this.abortControllers=new Map}async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{timeout:s=S.REQUEST.TIMEOUT,retries:r=S.REQUEST.RETRY_ATTEMPTS,headers:a={},onProgress:i,...o}=t,n=new AbortController,l=`${Date.now()}-${Math.random()}`;this.abortControllers.set(l,n);try{const t={...S.DEFAULT_HEADERS,...a},l=setTimeout(()=>{n.abort()},s);let d,u=0;for(;u<r;)try{const s=await fetch(e,{...o,headers:t,signal:n.signal});if(clearTimeout(l),!s.ok){const e=await s.text();let t;try{const r=JSON.parse(e);t=r.error||r.message||`HTTP ${s.status}`}catch{t=`HTTP ${s.status}: ${s.statusText}`}throw new Error(t)}if(i&&s.body){const e=s.headers.get("content-length");if(e){const t=parseInt(e,10);let r=0;const a=s.body.getReader(),o=[];for(;;){const{done:e,value:s}=await a.read();if(e)break;o.push(s),r+=s.length,i(r/t*100)}const n=new Uint8Array(o.reduce((e,t)=>e+t.length,0));let l=0;for(const e of o)n.set(e,l),l+=e.length;const c=(new TextDecoder).decode(n);return{success:!0,data:JSON.parse(c)}}}return{success:!0,data:await s.json()}}catch(c){if(d=c,c instanceof Error&&"AbortError"===c.name)throw new Error("\u0417\u0430\u043f\u0440\u043e\u0441 \u0431\u044b\u043b \u043e\u0442\u043c\u0435\u043d\u0435\u043d");if(u===r-1)throw d;const e=S.REQUEST.RETRY_DELAY*Math.pow(2,u);await new Promise(t=>setTimeout(t,e)),u++}throw d}catch(c){return console.error("API Request failed:",c),{success:!1,data:{},error:c instanceof Error?c.message:"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430",timestamp:(new Date).toISOString()}}finally{this.abortControllers.delete(l)}}async get(e,t,s){const r=P(e,t);return this.makeRequest(r,{method:"GET",...s})}async post(e,t,s){const r=P(e);return this.makeRequest(r,{method:"POST",body:t?JSON.stringify(t):void 0,...s})}async put(e,t,s){const r=P(e);return this.makeRequest(r,{method:"PUT",body:t?JSON.stringify(t):void 0,...s})}async delete(e,t){const s=P(e);return this.makeRequest(s,{method:"DELETE",...t})}async uploadFile(e,t,s){const r=P(e),{headers:a,...i}=s||{},o=a?{...a}:{};return delete o["Content-Type"],this.makeRequest(r,{method:"POST",body:t,headers:o,timeout:S.REQUEST.UPLOAD_TIMEOUT,...i})}cancelAllRequests(){this.abortControllers.forEach(e=>e.abort()),this.abortControllers.clear()}cancelRequest(e){const t=this.abortControllers.get(e);t&&(t.abort(),this.abortControllers.delete(e))}},w=S.BASE_URL;new class{async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=await fetch(`${w}${e}`,{headers:{"Content-Type":"application/json",...t.headers},...t});if(!s.ok)throw new Error(`API request failed: ${s.status} ${s.statusText}`);return s.json()}async uploadFiles(e){const t=new FormData;e.tzFile&&t.append("tz_file",e.tzFile),e.kpFiles&&e.kpFiles.forEach((e,s)=>{t.append(`kp_file_${s}`,e)}),e.additionalFiles&&e.additionalFiles.forEach((e,s)=>{t.append(`additional_file_${s}`,e)});const s=await N.uploadFile("UPLOAD",t,{timeout:S.REQUEST.UPLOAD_TIMEOUT});var r,a,i;return s.success?{success:!0,data:{tz_file:(null===(r=s.data)||void 0===r?void 0:r.tz_file)||null,kp_files:(null===(a=s.data)||void 0===a?void 0:a.kp_files)||[],additional_files:(null===(i=s.data)||void 0===i?void 0:i.additional_files)||[]}}:{success:!1,data:{tz_file:null,kp_files:[],additional_files:[]},error:s.error||"Upload failed"}}async analyzeKP(e,t,s,r){try{return{success:!0,data:await this.makeRequest("/analyze",{method:"POST",body:JSON.stringify({tz_file_path:e,kp_file_path:t,additional_files:s||[],model_id:r||"claude-3-5-sonnet-20240620"})})}}catch(a){return{success:!1,data:{},error:a instanceof Error?a.message:"Analysis failed"}}}async compareAllKP(e,t){try{return{success:!0,data:(await this.makeRequest("/compare-all",{method:"POST",body:JSON.stringify({analysis_results:e,model_id:t||"gpt-4o"})})).comparison_text}}catch(s){return{success:!1,data:"",error:s instanceof Error?s.message:"Comparison failed"}}}async generateReport(e,t){try{return{success:!0,data:(await this.makeRequest("/generate-report",{method:"POST",body:JSON.stringify({analysis_results:e,model_id:t||"gpt-4o"})})).report_text}}catch(s){return{success:!1,data:"",error:s instanceof Error?s.message:"Report generation failed"}}}async checkHealth(){return this.makeRequest("/health")}};const b=new class{constructor(){this.metrics={requestCount:0,errorCount:0,averageResponseTime:0,lastRequestTime:null,rateLimitStatus:{requestsPerMinute:0,analysisPerHour:0,fileUploadsPerHour:0}},this.requestLogs=[],this.requestTimestamps=[],this.analysisTimestamps=[],this.uploadTimestamps=[]}startRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET";const s=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,r=new Date,a={id:s,endpoint:e,method:t,startTime:r,status:"pending"};return this.requestLogs.push(a),this.requestTimestamps.push(r),this.cleanupTimestamps(),s}endRequest(e,t,s,r){const a=this.requestLogs.findIndex(t=>t.id===e);if(-1===a)return;const i=this.requestLogs[a],o=new Date,n=o.getTime()-i.startTime.getTime();i.endTime=o,i.duration=n,i.status=t?"success":"error",i.error=s,i.responseSize=r,this.metrics.requestCount++,this.metrics.lastRequestTime=o,t||this.metrics.errorCount++;const l=this.requestLogs.filter(e=>e.duration),c=l.reduce((e,t)=>e+(t.duration||0),0);this.metrics.averageResponseTime=c/l.length,i.endpoint.includes("/analyze")?this.analysisTimestamps.push(o):i.endpoint.includes("/upload")&&this.uploadTimestamps.push(o),this.requestLogs.length>100&&(this.requestLogs=this.requestLogs.slice(-100))}checkRateLimit(){const e=new Date,t=new Date(e.getTime()-6e4),s=new Date(e.getTime()-36e5),r=this.requestTimestamps.filter(e=>e>t).length,a=this.analysisTimestamps.filter(e=>e>s).length,i=this.uploadTimestamps.filter(e=>e>s).length;this.metrics.rateLimitStatus={requestsPerMinute:r,analysisPerHour:a,fileUploadsPerHour:i};const o={requestsPerMinute:r<S.RATE_LIMIT.REQUESTS_PER_MINUTE,analysisPerHour:a<S.RATE_LIMIT.ANALYSIS_PER_HOUR,fileUploadsPerHour:i<S.RATE_LIMIT.FILE_UPLOADS_PER_HOUR};return{allowed:Object.values(o).every(e=>e),limits:o}}getMetrics(){return{...this.metrics}}getRequestLogs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.requestLogs.slice(-e)}getErrorStats(){const e=this.requestLogs.filter(e=>"error"===e.status),t=this.metrics.requestCount>0?this.metrics.errorCount/this.metrics.requestCount*100:0,s={};return e.forEach(e=>{e.error&&(s[e.error]=(s[e.error]||0)+1)}),{errorRate:t,commonErrors:s}}getPerformanceStats(){const e=this.requestLogs.filter(e=>e.duration),t=e.filter(e=>(e.duration||0)>5e3),s=[...e].sort((e,t)=>(e.duration||0)-(t.duration||0)),r=s[0],a=s[s.length-1];return{averageResponseTime:this.metrics.averageResponseTime,slowRequests:t,fastestRequest:r,slowestRequest:a}}cleanupTimestamps(){const e=new Date(Date.now()-36e5);this.requestTimestamps=this.requestTimestamps.filter(t=>t>e),this.analysisTimestamps=this.analysisTimestamps.filter(t=>t>e),this.uploadTimestamps=this.uploadTimestamps.filter(t=>t>e)}resetMetrics(){this.metrics={requestCount:0,errorCount:0,averageResponseTime:0,lastRequestTime:null,rateLimitStatus:{requestsPerMinute:0,analysisPerHour:0,fileUploadsPerHour:0}},this.requestLogs=[],this.requestTimestamps=[],this.analysisTimestamps=[],this.uploadTimestamps=[]}exportMetrics(){const e={metrics:this.metrics,logs:this.requestLogs,errorStats:this.getErrorStats(),performanceStats:this.getPerformanceStats(),exportedAt:(new Date).toISOString()};return JSON.stringify(e,null,2)}};new class{async checkHealth(){const e=b.startRequest("/health","GET");try{const t=await N.get("HEALTH");return b.endRequest(e,t.success),t}catch(t){const s=t instanceof Error?t.message:"Health check failed";throw b.endRequest(e,!1,s),t}}async uploadFiles(e,t){const s=b.startRequest("/upload","POST");if(!b.checkRateLimit().allowed){const e="Rate limit exceeded for file uploads";return b.endRequest(s,!1,e),{success:!1,data:{tz_file:null,kp_files:[],additional_files:[]},error:e}}try{const r=[...e.tzFile?[e.tzFile]:[],...e.kpFiles||[],...e.additionalFiles||[]];for(const e of r){if(e.size>S.FILE_UPLOAD.MAX_SIZE){const t=`\u0424\u0430\u0439\u043b ${e.name} \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0435\u0442 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 ${S.FILE_UPLOAD.MAX_SIZE/1024/1024}MB`;return b.endRequest(s,!1,t),{success:!1,data:{tz_file:null,kp_files:[],additional_files:[]},error:t}}const t=e.name.toLowerCase().split(".").pop();if(!t||!S.FILE_UPLOAD.SUPPORTED_FORMATS.includes(t)){const t=`\u041d\u0435\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0444\u0430\u0439\u043b\u0430: ${e.name}`;return b.endRequest(s,!1,t),{success:!1,data:{tz_file:null,kp_files:[],additional_files:[]},error:t}}}const a=new FormData;e.tzFile&&a.append("tz_file",e.tzFile),e.kpFiles&&e.kpFiles.forEach((e,t)=>{a.append(`kp_file_${t}`,e)}),e.additionalFiles&&e.additionalFiles.forEach((e,t)=>{a.append(`additional_file_${t}`,e)});const i=await N.uploadFile("UPLOAD",a,{timeout:S.REQUEST.UPLOAD_TIMEOUT,onProgress:e=>{t&&t({loaded:e,total:100,percentage:e,stage:e<100?"uploading":"processing",message:e<100?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0444\u0430\u0439\u043b\u043e\u0432...":"\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0444\u0430\u0439\u043b\u043e\u0432..."})}});return b.endRequest(s,i.success,i.error),t&&i.success&&t({loaded:100,total:100,percentage:100,stage:"complete",message:"\u0424\u0430\u0439\u043b\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u044b"}),i}catch(r){const e=r instanceof Error?r.message:"Upload failed";return b.endRequest(s,!1,e),t&&t({loaded:0,total:100,percentage:0,stage:"error",message:e}),{success:!1,data:{tz_file:null,kp_files:[],additional_files:[]},error:e}}}async analyzeKP(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;const i=b.startRequest("/analyze","POST");if(!b.checkRateLimit().limits.analysisPerHour){const e="Rate limit exceeded for analysis operations";return b.endRequest(i,!1,e),{success:!1,data:{},error:e}}try{a&&a({step:1,totalSteps:4,currentOperation:"\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0430\u043d\u0430\u043b\u0438\u0437\u0430...",percentage:25});const o={tz_file_path:e,kp_file_path:t,additional_files:s,model_id:r||S.AI_MODELS.DEFAULT_ANALYSIS};a&&a({step:2,totalSteps:4,currentOperation:"\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432...",percentage:50});const n=await N.post("ANALYZE",o,{timeout:S.REQUEST.TIMEOUT});return a&&a({step:3,totalSteps:4,currentOperation:"\u0410\u043d\u0430\u043b\u0438\u0437 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u044f \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f\u043c...",percentage:75}),b.endRequest(i,n.success,n.error),a&&a({step:4,totalSteps:4,currentOperation:n.success?"\u0410\u043d\u0430\u043b\u0438\u0437 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d":"\u041e\u0448\u0438\u0431\u043a\u0430 \u0430\u043d\u0430\u043b\u0438\u0437\u0430",percentage:100}),n}catch(o){const e=o instanceof Error?o.message:"Analysis failed";return b.endRequest(i,!1,e),a&&a({step:4,totalSteps:4,currentOperation:`\u041e\u0448\u0438\u0431\u043a\u0430: ${e}`,percentage:100}),{success:!1,data:{},error:e}}}async compareAllKP(e,t){const s=b.startRequest("/compare-all","POST");try{const r={analysis_results:e,model_id:t||S.AI_MODELS.DEFAULT_COMPARISON},a=await N.post("ANALYTICS_PROCESS",r,{timeout:S.REQUEST.TIMEOUT});return b.endRequest(s,a.success,a.error),a}catch(r){const e=r instanceof Error?r.message:"Comparison failed";return b.endRequest(s,!1,e),{success:!1,data:"",error:e}}}async generateReport(e,t){const s=b.startRequest("/generate-report","POST");try{const r={analysis_results:e,model_id:t||S.AI_MODELS.DEFAULT_COMPARISON},a=await N.post("GENERATE_PDF_REPORT",r,{timeout:S.REQUEST.TIMEOUT});return b.endRequest(s,a.success,a.error),a}catch(r){const e=r instanceof Error?r.message:"Report generation failed";return b.endRequest(s,!1,e),{success:!1,data:"",error:e}}}async getAvailableModels(){const e=b.startRequest("/models","GET");try{const t=await N.get("ADMIN_STATS");return b.endRequest(e,t.success,t.error),t}catch(t){const s=t instanceof Error?t.message:"Failed to fetch models";return b.endRequest(e,!1,s),{success:!0,data:{analysis:[...S.AI_MODELS.AVAILABLE.CLAUDE,...S.AI_MODELS.AVAILABLE.OPENAI],comparison:[...S.AI_MODELS.AVAILABLE.OPENAI,...S.AI_MODELS.AVAILABLE.CLAUDE]}}}}async getUsageStats(){const e=b.startRequest("/usage/stats","GET");try{const t=await N.get("USAGE_STATS");return b.endRequest(e,t.success,t.error),t}catch(t){const s=t instanceof Error?t.message:"Failed to fetch usage stats";b.endRequest(e,!1,s);const r=b.getMetrics();return{success:!0,data:{requests_today:r.requestCount,analysis_count:r.rateLimitStatus.analysisPerHour,total_files_processed:r.rateLimitStatus.fileUploadsPerHour,average_processing_time:r.averageResponseTime}}}}};const O=new class{constructor(){}async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];try{return{data:await v.request({url:e,method:t.method||"GET",headers:{"Content-Type":"application/json",...t.headers},body:t.body,requiresAuth:s}),success:!0}}catch(r){return console.error("API request failed:",r),{data:{},success:!1,error:r instanceof Error?r.message:"Unknown error"}}}async uploadFiles(e){const t=new FormData;e.tzFile&&t.append("tz_file",e.tzFile),e.kpFiles&&e.kpFiles.forEach((e,s)=>{t.append(`kp_file_${s}`,e)}),e.additionalFiles&&e.additionalFiles.forEach((e,s)=>{t.append(`additional_file_${s}`,e)});try{return{data:await v.post("/upload",t,{headers:{}}),success:!0}}catch(s){return console.error("File upload failed:",s),{data:{},success:!1,error:s instanceof Error?s.message:"Upload failed"}}}async analyzeKP(e,t,s,r){return this.makeRequest("/analyze",{method:"POST",body:JSON.stringify({tz_file_path:e,kp_file_path:t,additional_files:s||[],model_id:r||"claude-3-5-sonnet-20240620"})})}async compareAllKP(e,t){return this.makeRequest("/compare-all",{method:"POST",body:JSON.stringify({analysis_results:e,model_id:t||"gpt-4o"})})}async generateReport(e,t){return this.makeRequest("/generate-report",{method:"POST",body:JSON.stringify({analysis_results:e,model_id:t||"gpt-4o"})})}async checkHealth(){return this.makeRequest("/health")}async get(e,t){const s=t?"?"+new URLSearchParams(t).toString():"",r=await this.makeRequest(`${e}${s}`);if(!r.success)throw new Error(r.error||"Request failed");return{data:r.data}}async post(e,t){const s=await this.makeRequest(e,{method:"POST",body:JSON.stringify(t)});if(!s.success)throw new Error(s.error||"Request failed");return{data:s.data}}};var I=s(4414);s(2449);let C=function(e){return e.DOCUMENT_UPLOADED="document_uploaded",e.ANALYSIS_STARTED="analysis_started",e.ANALYSIS_COMPLETED="analysis_completed",e.REPORT_GENERATED="report_generated",e.USER_REGISTERED="user_registered",e.PROJECT_CREATED="project_created",e.SETTINGS_UPDATED="settings_updated",e}({});const L=new class{constructor(){this.baseUrl="/activity"}async getActivityFeed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await O.get(this.baseUrl,e)).data}catch(t){return console.error("Backend unavailable, using local data:",t),this.getLocalActivityFeed(e)}}async getProjectActivity(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return(await O.get(`${this.baseUrl}/project/${e}`,t)).data}catch(s){return console.error("Error fetching project activity:",s),this.getLocalActivityFeed({...t,project_id:e})}}async createActivity(e){try{return(await O.post(this.baseUrl,e)).data}catch(t){throw console.error("Error creating activity:",t),t}}getLocalActivityFeed(e){const t=this.getAnalysisHistoryActivities();if(0===t.length)return{activities:[],total:0,has_more:!1};let s=t;e.project_id&&(s=s.filter(t=>t.project_id===e.project_id)),e.activity_type&&(s=s.filter(t=>t.type===e.activity_type)),e.user_id&&(s=s.filter(t=>t.user_id===e.user_id));const r=e.limit||10,a=e.offset||0;return{activities:s.slice(a,a+r),total:s.length,has_more:a+r<s.length}}getAnalysisHistoryActivities(){try{const e=localStorage.getItem("kp_analyzer_history");if(!e)return[];return JSON.parse(e).map((e,t)=>{var s;const r=e.id||`analysis_${t+1}`,a=e.results||[],i=e.ranking||[];let o=0;a.length>0?o=a.reduce((e,t)=>e+(t.complianceScore||t.overallRating||0),0)/a.length:i.length>0&&(o=i.reduce((e,t)=>e+(t.totalScore||0),0)/i.length);const n=a.length||i.length,l=e.analyzedAt||e.createdAt||(new Date).toISOString();return{id:r,type:C.ANALYSIS_COMPLETED,title:"\u0410\u043d\u0430\u043b\u0438\u0437 \u041a\u041f \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d",description:`\u0410\u043d\u0430\u043b\u0438\u0437 ${n} \u043a\u043e\u043c\u043c\u0435\u0440\u0447\u0435\u0441\u043a\u0438\u0445 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u0439 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d \u0441 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u043c ${o.toFixed(1)}%`,user_id:1,analysis_id:r,created_at:l,updated_at:l,project_metadata:{compliance_score:o,documents_count:n,model_used:e.model||"unknown",best_choice:e.bestChoice||(null===(s=e.recommendation)||void 0===s?void 0:s.winner)||"N/A"}}}).sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime())}catch(e){return console.error("Error parsing analysis history:",e),[]}}getMockActivityFeed(e){return this.getAnalysisHistoryActivities().length>0?this.getLocalActivityFeed(e):{activities:[],total:0,has_more:!1}}getActivityIcon(e){return{[C.DOCUMENT_UPLOADED]:"\ud83d\udcc4",[C.ANALYSIS_STARTED]:"\ud83d\udd04",[C.ANALYSIS_COMPLETED]:"\u2705",[C.REPORT_GENERATED]:"\ud83d\udcca",[C.USER_REGISTERED]:"\ud83d\udc64",[C.PROJECT_CREATED]:"\ud83c\udfd7\ufe0f",[C.SETTINGS_UPDATED]:"\u2699\ufe0f"}[e]||"\ud83d\udccb"}getActivityColor(e){return{[C.DOCUMENT_UPLOADED]:"text-blue-600",[C.ANALYSIS_STARTED]:"text-yellow-600",[C.ANALYSIS_COMPLETED]:"text-green-600",[C.REPORT_GENERATED]:"text-purple-600",[C.USER_REGISTERED]:"text-indigo-600",[C.PROJECT_CREATED]:"text-emerald-600",[C.SETTINGS_UPDATED]:"text-gray-600"}[e]||"text-gray-500"}formatRelativeTime(e){const t=new Date(e),s=new Date,r=Math.floor((s.getTime()-t.getTime())/1e3);if(r<60)return"\u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u043e";if(r<3600){return`${Math.floor(r/60)} \u043c\u0438\u043d \u043d\u0430\u0437\u0430\u0434`}if(r<86400){return`${Math.floor(r/3600)} \u0447 \u043d\u0430\u0437\u0430\u0434`}if(r<2592e3){return`${Math.floor(r/86400)} \u0434\u043d \u043d\u0430\u0437\u0430\u0434`}return t.toLocaleDateString("ru-RU",{day:"numeric",month:"short",year:"numeric"})}},U=e=>{let{activity:t,showProject:s=!0,className:r=""}=e;const a=L.getActivityIcon(t.type),i=L.getActivityColor(t.type),o=L.formatRelativeTime(t.created_at);return(0,I.jsxs)("div",{className:`group relative ${r}`,children:[(0,I.jsx)("div",{className:"absolute left-0 top-3 w-2 h-2 bg-gray-300 rounded-full group-hover:bg-blue-500 transition-colors"}),(0,I.jsx)("div",{className:"ml-6 pb-4",children:(0,I.jsxs)("div",{className:"flex items-start justify-between",children:[(0,I.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,I.jsxs)("div",{className:"flex items-center gap-2",children:[(0,I.jsx)("span",{className:"text-lg",children:a}),(0,I.jsx)("h4",{className:`text-sm font-medium ${i}`,children:t.title}),(0,I.jsx)("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:o})]}),(0,I.jsx)("p",{className:"text-sm text-gray-600 mt-1 leading-relaxed",children:t.description}),(()=>{const e=t.project_metadata||{};switch(t.type){case C.ANALYSIS_COMPLETED:return(0,I.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[e.compliance_score&&(0,I.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:["\u0421\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435: ",e.compliance_score,"%"]}),e.total_amount&&(0,I.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(e.total_amount)})]});case C.DOCUMENT_UPLOADED:return(0,I.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[e.pages_count&&(0,I.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-700",children:[e.pages_count," \u0441\u0442\u0440."]}),e.document_size&&(0,I.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-700",children:[(e.document_size/1024/1024).toFixed(1)," \u041c\u0411"]})]});case C.ANALYSIS_STARTED:return(0,I.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[e.ai_model&&(0,I.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-purple-100 text-purple-800",children:e.ai_model}),e.documents_count&&(0,I.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800",children:[e.documents_count," \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432"]})]});case C.REPORT_GENERATED:return(0,I.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[e.format&&(0,I.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-indigo-100 text-indigo-800",children:e.format.toUpperCase()}),e.file_size&&(0,I.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-700",children:[(e.file_size/1024/1024).toFixed(1)," \u041c\u0411"]})]});default:return null}})(),s&&t.project&&(0,I.jsx)("div",{className:"mt-2",children:(0,I.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-600",children:["\ud83c\udfd7\ufe0f ",t.project.name]})})]}),(0,I.jsx)("div",{className:"ml-4 flex-shrink-0",children:(()=>{switch(t.type){case C.ANALYSIS_COMPLETED:return(0,I.jsx)("button",{className:"text-xs text-blue-600 hover:text-blue-800 hover:underline",children:"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442"});case C.REPORT_GENERATED:return(0,I.jsx)("button",{className:"text-xs text-purple-600 hover:text-purple-800 hover:underline",children:"\u0421\u043a\u0430\u0447\u0430\u0442\u044c \u043e\u0442\u0447\u0451\u0442"});case C.DOCUMENT_UPLOADED:return(0,I.jsx)("button",{className:"text-xs text-green-600 hover:text-green-800 hover:underline",children:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442"});default:return null}})()})]})})]})};var k=s(8622);const D=e=>{let{projectId:t,limit:s=10,showFilters:a=!0,showHeader:i=!0,className:o="",autoRefresh:n=!1,refreshInterval:l=30}=e;const[c,d]=(0,r.useState)([]),[u,h]=(0,r.useState)(!0),[p,m]=(0,r.useState)(null),[_,g]=(0,r.useState)(!1),[E,A]=(0,r.useState)(0),[y,T]=(0,r.useState)({limit:s,offset:0}),R=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y;try{h(!0),m(null);const s=t?await L.getProjectActivity(t,e):await L.getActivityFeed(e);0===e.offset?d(s.activities):d(e=>[...e,...s.activities]),g(s.has_more),A(s.total)}catch(s){m("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438"),console.error("Error loading activity:",s)}finally{h(!1)}};(0,r.useEffect)(()=>{R({...y,offset:0})},[t,y.activity_type,y.limit]),(0,r.useEffect)(()=>{if(!n)return;const e=setInterval(()=>{R({...y,offset:0})},1e3*l);return()=>clearInterval(e)},[n,l,y]);const f=()=>{R({...y,offset:0})},x=[{value:void 0,label:"\u0412\u0441\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f"},{value:C.DOCUMENT_UPLOADED,label:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432"},{value:C.ANALYSIS_STARTED,label:"\u041d\u0430\u0447\u0430\u043b\u043e \u0430\u043d\u0430\u043b\u0438\u0437\u0430"},{value:C.ANALYSIS_COMPLETED,label:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435 \u0430\u043d\u0430\u043b\u0438\u0437\u0430"},{value:C.REPORT_GENERATED,label:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043e\u0442\u0447\u0451\u0442\u043e\u0432"},{value:C.PROJECT_CREATED,label:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432"},{value:C.SETTINGS_UPDATED,label:"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a"}];return p?(0,I.jsx)("div",{className:`bg-white rounded-lg shadow-sm border p-6 ${o}`,children:(0,I.jsxs)("div",{className:"text-center",children:[(0,I.jsx)("div",{className:"text-red-500 mb-2",children:"\u26a0\ufe0f"}),(0,I.jsx)("p",{className:"text-red-600 mb-4",children:p}),(0,I.jsx)("button",{onClick:f,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"\u041f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0441\u043d\u043e\u0432\u0430"})]})}):(0,I.jsxs)("div",{className:`bg-white rounded-lg shadow-sm border ${o}`,children:[i&&(0,I.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,I.jsxs)("div",{className:"flex items-center justify-between",children:[(0,I.jsxs)("div",{children:[(0,I.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}),E>0&&(0,I.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["\u0412\u0441\u0435\u0433\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u0439: ",E]})]}),(0,I.jsxs)("div",{className:"flex items-center gap-3",children:[n&&(0,I.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,I.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"\u0410\u0432\u0442\u043e\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435"]}),(0,I.jsx)("button",{onClick:f,disabled:u,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors disabled:opacity-50",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c",children:(0,I.jsx)("svg",{className:"w-4 h-4 "+(u?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,I.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]}),a&&(0,I.jsx)("div",{className:"mt-4",children:(0,I.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,I.jsx)("span",{className:"text-sm text-gray-500",children:"\u0424\u0438\u043b\u044c\u0442\u0440:"}),x.map(e=>(0,I.jsx)("button",{onClick:()=>(e=>{const t={...y,activity_type:e,offset:0};T(t)})(e.value),className:`px-3 py-1 rounded-full text-xs transition-colors ${y.activity_type===e.value?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-600 hover:bg-gray-200 border-gray-200"} border`,children:e.label},e.label))]})})]}),(0,I.jsx)("div",{className:"p-6",children:u&&0===c.length?(0,I.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,I.jsx)(k.A,{size:"md"}),(0,I.jsx)("span",{className:"ml-3 text-gray-500",children:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c..."})]}):0===c.length?(0,I.jsxs)("div",{className:"text-center py-8",children:[(0,I.jsx)("div",{className:"text-gray-400 text-4xl mb-4",children:"\ud83d\udccb"}),(0,I.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430"}),(0,I.jsx)("p",{className:"text-gray-500",children:y.activity_type?"\u041d\u0435\u0442 \u0441\u043e\u0431\u044b\u0442\u0438\u0439 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u0438\u043f\u0430":"\u041f\u043e\u043a\u0430 \u043d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f"})]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{className:"relative",children:[(0,I.jsx)("div",{className:"absolute left-1 top-0 bottom-0 w-px bg-gray-200"}),(0,I.jsx)("div",{className:"space-y-1",children:c.map((e,s)=>(0,I.jsx)(U,{activity:e,showProject:!t},`${e.id}-${s}`))})]}),_&&(0,I.jsx)("div",{className:"mt-6 text-center",children:(0,I.jsx)("button",{onClick:()=>{if(!_||u)return;const e={...y,offset:c.length};T(e),R(e)},disabled:u,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:u?(0,I.jsxs)("div",{className:"flex items-center gap-2",children:[(0,I.jsx)(k.A,{size:"sm"}),"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c..."]}):"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451"})})]})})]})};s(3885),s(244),s(1035);var j=s(8832),M=s(2624),q=s(5175);const F=new class{constructor(){this.baseURL="http://46.149.71.162:8000"}async uploadDocument(e,t){const s=new FormData;s.append("file",e),s.append("role",t);try{const e=await fetch(`${this.baseURL}/api/kp-analyzer/upload`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("devassist_simple_token")}`},body:s});if(!e.ok)throw new Error(`Upload failed: ${e.statusText}`);return(await e.json()).data}catch(r){throw console.error("[KPAnalyzerService] Upload error:",r),r}}async getAvailableModels(){try{const e=await fetch(`${this.baseURL}/api/llm/models`,{headers:{Authorization:`Bearer ${localStorage.getItem("devassist_simple_token")}`}});if(!e.ok)throw new Error(`Failed to fetch models: ${e.statusText}`);return(await e.json()).data}catch(e){return console.error("[KPAnalyzerService] Get models error:",e),this.getFallbackModels()}}async startAnalysis(e){try{const t=await fetch(`${this.baseURL}/api/kp-analyzer/analyze`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("devassist_simple_token")}`},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Analysis failed: ${t.statusText}`);return(await t.json()).data}catch(t){throw console.error("[KPAnalyzerService] Start analysis error:",t),t}}async getAnalysisStatus(e){try{const t=await fetch(`${this.baseURL}/api/kp-analyzer/status/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("devassist_simple_token")}`}});if(!t.ok)throw new Error(`Failed to get status: ${t.statusText}`);return(await t.json()).data}catch(t){throw console.error("[KPAnalyzerService] Get status error:",t),t}}async getAnalysisResults(e){try{const t=await fetch(`${this.baseURL}/api/kp-analyzer/results/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("devassist_simple_token")}`}});if(!t.ok)throw new Error(`Failed to get results: ${t.statusText}`);return(await t.json()).data}catch(t){throw console.error("[KPAnalyzerService] Get results error:",t),t}}subscribeToAnalysisUpdates(e,t,s){const r=`${this.baseURL.replace("http","ws")}/api/kp-analyzer/subscribe/${e}`,a=new WebSocket(r);return a.onmessage=e=>{try{const s=JSON.parse(e.data);t(s)}catch(r){s(new Error("Failed to parse WebSocket message"))}},a.onerror=()=>{s(new Error("WebSocket connection failed"))},a.onclose=()=>{console.log("[KPAnalyzerService] WebSocket connection closed")},()=>{a.close()}}getFallbackModels(){return[{id:"claude-3-5-sonnet",name:"Claude 3.5 Sonnet",provider:"anthropic",model:"claude-3-5-sonnet-20241022",temperature:.1,maxTokens:4e3,available:!0},{id:"gpt-4o",name:"GPT-4o",provider:"openai",model:"gpt-4o",temperature:.1,maxTokens:4e3,available:!0},{id:"gemini-pro",name:"Gemini Pro",provider:"google",model:"gemini-pro",temperature:.1,maxTokens:4e3,available:!0}]}saveAnalysisToHistory(e){try{const t="kp_analyzer_history",s=[e,...JSON.parse(localStorage.getItem(t)||"[]").slice(0,19)];localStorage.setItem(t,JSON.stringify(s)),console.log("[KPAnalyzerService] Analysis saved to history:",e.id)}catch(t){console.error("[KPAnalyzerService] Failed to save to history:",t)}}async getAnalysisHistory(){try{const e="kp_analyzer_history";return JSON.parse(localStorage.getItem(e)||"[]")}catch(e){return console.error("[KPAnalyzerService] Failed to load history:",e),[]}}},H=()=>{var e,t,s,l,x,v,S,P,N,w,b,O,C,L,U,k,H,z,$,K,B,W,G,V,Y,J,Q,Z,X,ee,te,se,re,ae;const ie=(0,a.Zp)(),{isDarkMode:oe,toggleTheme:ne}=(0,f.D)(),{isAuthenticated:le,isLoading:ce,logout:de}=(0,i.A)(),[ue,he]=(0,r.useState)("modules");(0,q.A)();const[pe,me]=(0,r.useState)({openai:null,anthropic:null}),[_e,ge]=(0,r.useState)(new Map),[Ee,Ae]=(0,r.useState)(!1),[ye,Te]=(0,r.useState)(!1);(0,r.useEffect)(()=>{ce||le||ie("/auth/login",{replace:!0})},[le,ce,ie]),(0,r.useEffect)(()=>()=>{},[]),(0,r.useEffect)(()=>{},[oe]),(0,r.useEffect)(()=>{(async()=>{Ae(!0);try{const c=(0,o.S2)(),d=await fetch(`${c}/api/llm/providers`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!d.ok)throw new Error(`Backend API error: ${d.status}`);const u=(await d.json()).providers||{},h=await fetch(`${c}/api/llm/health`),p=h.ok?await h.json():null,m=new Map,_={openai:!1,anthropic:!1};if(u.openai){var e,t,s,r;const a=!0===(null===p||void 0===p||null===(e=p.providers)||void 0===e||null===(t=e.openai)||void 0===t?void 0:t.configured)&&"healthy"===(null===p||void 0===p||null===(s=p.providers)||void 0===s||null===(r=s.openai)||void 0===r?void 0:r.status);_.openai=a,m.set("openai",{ok:a,error:a?void 0:{code:"SERVICE_ERROR",message:"OpenAI provider \u043d\u0435 \u0433\u043e\u0442\u043e\u0432 \u0438\u043b\u0438 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d"}})}else _.openai=!1,m.set("openai",{ok:!1,error:{code:"NO_API_KEY",message:"OpenAI API key not configured"}});if(u.anthropic){var a,i,n,l;const e=!0===(null===p||void 0===p||null===(a=p.providers)||void 0===a||null===(i=a.anthropic)||void 0===i?void 0:i.configured)&&"healthy"===(null===p||void 0===p||null===(n=p.providers)||void 0===n||null===(l=n.anthropic)||void 0===l?void 0:l.status);_.anthropic=e,m.set("anthropic",{ok:e,error:e?void 0:{code:"SERVICE_ERROR",message:"Anthropic provider \u043d\u0435 \u0433\u043e\u0442\u043e\u0432 \u0438\u043b\u0438 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d"}})}else _.anthropic=!1,m.set("anthropic",{ok:!1,error:{code:"NO_API_KEY",message:"Anthropic API key not configured"}});me(_),ge(m)}catch(c){const e=c instanceof Error?c.message:"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430";me({openai:!1,anthropic:!1}),ge(new Map([["openai",{ok:!1,error:{code:"BACKEND_ERROR",message:`Backend \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d: ${e}`}}],["anthropic",{ok:!1,error:{code:"BACKEND_ERROR",message:`Backend \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d: ${e}`}}]]))}Ae(!1)})()},[]);const[Re,fe]=(0,r.useState)([]),[xe,ve]=(0,r.useState)(!1),Se=async()=>{ve(!0);try{const e=(await F.getAnalysisHistory()).map((e,t)=>{var s,r,a;const i=(e.kp_results||[])[0]||{};return{id:(null===(s=e.analysis_id)||void 0===s?void 0:s.toString())||t.toString(),companyName:i.company_name||`\u041a\u043e\u043c\u043f\u0430\u043d\u0438\u044f ${t+1}`,proposalName:i.proposal_name||"\u041a\u043e\u043c\u043c\u0435\u0440\u0447\u0435\u0441\u043a\u043e\u0435 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u0435",overallScore:i.overall_score||0,maxScore:100,criteria:{technical:i.technical_score||0,commercial:i.commercial_score||0,timeline:i.timeline_score||0,experience:i.experience_score||0,compliance:i.compliance_score||0},budget:{total:i.total_budget||0,breakdown:{development:i.development_cost||0,testing:i.testing_cost||0,deployment:i.deployment_cost||0,support:i.support_cost||0,other:i.other_cost||0}},metadata:{submissionDate:(null===(r=e.created_at)||void 0===r?void 0:r.split("T")[0])||(new Date).toISOString().split("T")[0],evaluationDate:(null===(a=e.updated_at)||void 0===a?void 0:a.split("T")[0])||(new Date).toISOString().split("T")[0],evaluator:"AI \u0421\u0438\u0441\u0442\u0435\u043c\u0430",status:"evaluated"}}});fe(e)}catch(e){fe([])}finally{ve(!1)}};(0,r.useEffect)(()=>{Se()},[]);const Pe=[{id:"kp-analyzer",title:"\u041a\u041f \u0410\u043d\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440",description:"\u0410\u043d\u0430\u043b\u0438\u0437 \u043a\u043e\u043c\u043c\u0435\u0440\u0447\u0435\u0441\u043a\u0438\u0445 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u0439 \u043f\u0440\u043e\u0442\u0438\u0432 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0437\u0430\u0434\u0430\u043d\u0438\u0439 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e AI",icon:(0,I.jsx)(n.A,{className:"w-6 h-6"}),status:"active",href:"/kp-analyzer"},{id:"tz-generator",title:"\u0422\u0417 \u0413\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440",description:"\u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0437\u0430\u0434\u0430\u043d\u0438\u0439",icon:(0,I.jsx)(c,{className:"w-6 h-6"}),status:"coming_soon",href:"/tz-generator"},{id:"project-evaluation",title:"\u041e\u0446\u0435\u043d\u043a\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432",description:"\u0410\u043d\u0430\u043b\u0438\u0437 \u0438 \u043e\u0446\u0435\u043d\u043a\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432 \u043d\u0435\u0434\u0432\u0438\u0436\u0438\u043c\u043e\u0441\u0442\u0438",icon:(0,I.jsx)(d.A,{className:"w-6 h-6"}),status:"coming_soon",href:"/project-evaluation"},{id:"marketing-planner",title:"\u041c\u0430\u0440\u043a\u0435\u0442\u0438\u043d\u0433 \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0449\u0438\u043a",description:"\u041f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043c\u0430\u0440\u043a\u0435\u0442\u0438\u043d\u0433\u043e\u0432\u044b\u0445 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0439",icon:(0,I.jsx)(u.A,{className:"w-6 h-6"}),status:"coming_soon",href:"/marketing-planner"},{id:"knowledge-base",title:"\u0411\u0430\u0437\u0430 \u0437\u043d\u0430\u043d\u0438\u0439",description:"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u043c\u0438 \u0438 \u0437\u043d\u0430\u043d\u0438\u044f\u043c\u0438",icon:(0,I.jsx)(h.A,{className:"w-6 h-6"}),status:"coming_soon",href:"/knowledge-base"}];return(0,I.jsxs)("div",{className:"min-h-screen transition-colors duration-300 "+(oe?"bg-gray-900 text-white":"bg-gray-50 text-gray-900"),children:[(0,I.jsx)(M.K,{isCollapsed:ye,onToggle:Te}),(0,I.jsxs)("div",{className:"transition-all duration-300 "+(ye?"md:ml-16":"md:ml-64"),children:[(0,I.jsx)("header",{className:"border-b transition-colors duration-300 "+(oe?"border-gray-800 bg-gray-900":"border-gray-200 bg-white"),children:(0,I.jsx)("div",{className:"px-4 sm:px-6 lg:px-8",children:(0,I.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,I.jsxs)("div",{className:"flex items-center space-x-3 md:ml-0 ml-12",children:[(0,I.jsx)("h1",{className:"text-xl font-semibold",children:"\u0414\u0430\u0448\u0431\u043e\u0440\u0434"}),(0,I.jsx)("span",{className:"text-sm px-2 py-1 rounded-full "+(oe?"bg-gray-800 text-gray-300":"bg-gray-100 text-gray-600"),children:"DevAssist Pro"})]}),(0,I.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,I.jsx)("button",{onClick:ne,className:"p-2 rounded-lg transition-colors "+(oe?"hover:bg-gray-800 text-gray-400 hover:text-white":"hover:bg-gray-100 text-gray-600 hover:text-gray-900"),children:oe?(0,I.jsx)(p.A,{className:"w-5 h-5"}):(0,I.jsx)(m.A,{className:"w-5 h-5"})}),(0,I.jsx)("button",{onClick:()=>ie("/profile"),className:"p-2 rounded-lg transition-colors "+(oe?"hover:bg-gray-800 text-gray-400 hover:text-white":"hover:bg-gray-100 text-gray-600 hover:text-gray-900"),children:(0,I.jsx)(_.A,{className:"w-5 h-5"})})]})]})})}),(0,I.jsxs)("main",{className:"px-4 sm:px-6 lg:px-8 py-8",children:[(0,I.jsxs)("div",{className:"mb-8",children:[(0,I.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u0432 DevAssist Pro"}),(0,I.jsx)("p",{className:"text-lg "+(oe?"text-gray-400":"text-gray-600"),children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043c\u043e\u0434\u0443\u043b\u044c \u0434\u043b\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u0440\u0430\u0431\u043e\u0442\u044b"})]}),(0,I.jsx)("div",{className:"mb-8",children:(0,I.jsxs)("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg w-fit",children:[(0,I.jsxs)("button",{onClick:()=>he("modules"),className:"flex items-center space-x-2 px-4 py-2 rounded-md text-sm font-medium transition-colors "+("modules"===ue?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"),children:[(0,I.jsx)(n.A,{className:"w-4 h-4"}),(0,I.jsx)("span",{children:"\u041c\u043e\u0434\u0443\u043b\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b"})]}),(0,I.jsxs)("button",{onClick:()=>he("visualization"),className:"flex items-center space-x-2 px-4 py-2 rounded-md text-sm font-medium transition-colors "+("visualization"===ue?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"),children:[(0,I.jsx)(g.A,{className:"w-4 h-4"}),(0,I.jsx)("span",{children:"\u0412\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f"})]}),(0,I.jsxs)("button",{onClick:()=>he("comparison"),className:"flex items-center space-x-2 px-4 py-2 rounded-md text-sm font-medium transition-colors "+("comparison"===ue?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"),children:[(0,I.jsx)(E,{className:"w-4 h-4"}),(0,I.jsx)("span",{children:"\u0421\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0435 \u041a\u041f"})]})]})}),(0,I.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8",children:[(0,I.jsx)("div",{className:"lg:col-span-2",children:"modules"===ue?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("h3",{className:"text-base sm:text-lg font-semibold mb-4",children:"\u041c\u043e\u0434\u0443\u043b\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b"}),(0,I.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:Pe.map(e=>(0,I.jsxs)("div",{onClick:()=>(e=>{"active"===e.status&&ie(e.href)})(e),className:`group relative rounded-xl border p-4 sm:p-6 transition-all duration-200 ${oe?"bg-gray-800 border-gray-700 hover:bg-gray-750":"bg-white border-gray-200 hover:bg-gray-50"} ${"active"===e.status?"cursor-pointer hover:shadow-lg":"cursor-not-allowed opacity-60"}`,children:[(0,I.jsx)("div",{className:"absolute top-3 right-3 sm:top-4 sm:right-4",children:"active"===e.status?(0,I.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:"\u0410\u043a\u0442\u0438\u0432\u0435\u043d"}):(0,I.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-700",children:"\u0421\u043a\u043e\u0440\u043e"})}),(0,I.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-lg flex items-center justify-center mb-3 sm:mb-4 "+("active"===e.status?"bg-blue-600 text-white":oe?"bg-gray-700 text-gray-400":"bg-gray-100 text-gray-400"),children:e.icon}),(0,I.jsxs)("div",{className:"mb-4",children:[(0,I.jsx)("h3",{className:"text-lg font-semibold mb-2",children:e.title}),(0,I.jsx)("p",{className:"text-sm "+(oe?"text-gray-400":"text-gray-600"),children:e.description})]}),"active"===e.status&&(0,I.jsxs)("div",{className:"flex items-center text-sm font-medium text-blue-600 group-hover:text-blue-700",children:[(0,I.jsx)("span",{children:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c"}),(0,I.jsx)(A.A,{className:"w-4 h-4 ml-1 transform group-hover:translate-x-1 transition-transform"})]})]},e.id))})]}):"visualization"===ue?(0,I.jsx)(j.default,{results:Re,showFilters:!0,showExportOptions:!0,onExport:e=>{},onRefresh:()=>{Se()}}):(0,I.jsxs)("div",{className:"text-gray-400 text-center py-8",children:[(0,I.jsx)(n.A,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,I.jsx)("p",{children:"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f"}),(0,I.jsx)("p",{className:"text-sm mt-2",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u041a\u041f \u0434\u043b\u044f \u0430\u043d\u0430\u043b\u0438\u0437\u0430"})]})}),(0,I.jsxs)("div",{className:"lg:col-span-1",children:[(0,I.jsxs)("div",{className:"flex flex-col gap-2 mb-4",children:[(0,I.jsxs)("div",{className:"flex items-center gap-2",children:[(0,I.jsx)("span",{className:"font-semibold",children:"Claude API"}),Ee?(0,I.jsx)(y.A,{className:"w-4 h-4 text-blue-500 animate-spin"}):!0===pe.anthropic?(0,I.jsx)("span",{title:"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043e",children:(0,I.jsx)(T.A,{className:"w-4 h-4 text-green-500"})}):(0,I.jsx)("span",{title:"\u041d\u0435\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f",children:(0,I.jsx)(R.A,{className:"w-4 h-4 text-red-500"})})]}),(null===(e=_e.get("anthropic"))||void 0===e?void 0:e.error)&&(0,I.jsxs)("div",{className:"ml-6 text-xs text-red-400 break-all",children:[(0,I.jsxs)("div",{children:["\u041a\u043e\u0434: ",null===(t=_e.get("anthropic"))||void 0===t||null===(s=t.error)||void 0===s?void 0:s.code]}),(null===(l=_e.get("anthropic"))||void 0===l||null===(x=l.error)||void 0===x?void 0:x.status)&&(0,I.jsxs)("div",{children:["HTTP: ",null===(v=_e.get("anthropic"))||void 0===v||null===(S=v.error)||void 0===S?void 0:S.status]}),(0,I.jsxs)("div",{children:["\u041e\u0448\u0438\u0431\u043a\u0430: ",null===(P=_e.get("anthropic"))||void 0===P||null===(N=P.error)||void 0===N?void 0:N.message]}),"NO_API_KEY"===(null===(w=_e.get("anthropic"))||void 0===w||null===(b=w.error)||void 0===b?void 0:b.code)&&(0,I.jsx)("div",{className:"mt-1 text-yellow-400",children:"\ud83d\udca1 \u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 REACT_APP_ANTHROPIC_API_KEY \u0432 .env \u0444\u0430\u0439\u043b"}),"TypeError"===(null===(O=_e.get("anthropic"))||void 0===O||null===(C=O.error)||void 0===C?void 0:C.code)&&(0,I.jsx)("div",{className:"mt-1 text-yellow-400",children:"\ud83c\udf10 CORS \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 - \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 mock \u0440\u0435\u0436\u0438\u043c \u0438\u043b\u0438 backend proxy"}),"BACKEND_ERROR"===(null===(L=_e.get("anthropic"))||void 0===L||null===(U=L.error)||void 0===U?void 0:U.code)&&(0,I.jsx)("div",{className:"mt-1 text-yellow-400",children:"\ud83d\udd0c \u041f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 \u0441 backend API - \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435, \u0447\u0442\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u044b \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u044b"}),"SERVICE_ERROR"===(null===(k=_e.get("anthropic"))||void 0===k||null===(H=k.error)||void 0===H?void 0:H.code)&&(0,I.jsx)("div",{className:"mt-1 text-yellow-400",children:"\u26a0\ufe0f \u0421\u0435\u0440\u0432\u0438\u0441 \u0437\u0430\u043f\u0443\u0449\u0435\u043d, \u043d\u043e provider \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d"})]}),(0,I.jsxs)("div",{className:"flex items-center gap-2",children:[(0,I.jsx)("span",{className:"font-semibold",children:"ChatGPT API"}),Ee?(0,I.jsx)(y.A,{className:"w-4 h-4 text-blue-500 animate-spin"}):!0===pe.openai?(0,I.jsx)("span",{title:"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043e",children:(0,I.jsx)(T.A,{className:"w-4 h-4 text-green-500"})}):(0,I.jsx)("span",{title:"\u041d\u0435\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f",children:(0,I.jsx)(R.A,{className:"w-4 h-4 text-red-500"})})]}),(null===(z=_e.get("openai"))||void 0===z?void 0:z.error)&&(0,I.jsxs)("div",{className:"ml-6 text-xs text-red-400 break-all",children:[(0,I.jsxs)("div",{children:["\u041a\u043e\u0434: ",null===($=_e.get("openai"))||void 0===$||null===(K=$.error)||void 0===K?void 0:K.code]}),(null===(B=_e.get("openai"))||void 0===B||null===(W=B.error)||void 0===W?void 0:W.status)&&(0,I.jsxs)("div",{children:["HTTP: ",null===(G=_e.get("openai"))||void 0===G||null===(V=G.error)||void 0===V?void 0:V.status]}),(0,I.jsxs)("div",{children:["\u041e\u0448\u0438\u0431\u043a\u0430: ",null===(Y=_e.get("openai"))||void 0===Y||null===(J=Y.error)||void 0===J?void 0:J.message]}),"NO_API_KEY"===(null===(Q=_e.get("openai"))||void 0===Q||null===(Z=Q.error)||void 0===Z?void 0:Z.code)&&(0,I.jsx)("div",{className:"mt-1 text-yellow-400",children:"\ud83d\udca1 \u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 REACT_APP_OPENAI_API_KEY \u0432 .env \u0444\u0430\u0439\u043b"}),"invalid_api_key"===(null===(X=_e.get("openai"))||void 0===X||null===(ee=X.error)||void 0===ee?void 0:ee.code)&&(0,I.jsx)("div",{className:"mt-1 text-yellow-400",children:'\ud83d\udd11 \u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u043a\u043b\u044e\u0447\u0430! \u0414\u043e\u043b\u0436\u0435\u043d \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0441 "sk-"'}),"BACKEND_ERROR"===(null===(te=_e.get("openai"))||void 0===te||null===(se=te.error)||void 0===se?void 0:se.code)&&(0,I.jsx)("div",{className:"mt-1 text-yellow-400",children:"\ud83d\udd0c \u041f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 \u0441 backend API - \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435, \u0447\u0442\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u044b \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u044b"}),"SERVICE_ERROR"===(null===(re=_e.get("openai"))||void 0===re||null===(ae=re.error)||void 0===ae?void 0:ae.code)&&(0,I.jsx)("div",{className:"mt-1 text-yellow-400",children:"\u26a0\ufe0f \u0421\u0435\u0440\u0432\u0438\u0441 \u0437\u0430\u043f\u0443\u0449\u0435\u043d, \u043d\u043e provider \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d"})]})]}),(0,I.jsx)(D,{limit:8,showFilters:!1,autoRefresh:!0,refreshInterval:60,className:"h-fit"})]})]})]})]})]})}},3270:(e,t,s)=>{s.d(t,{A:()=>r});const r=(0,s(9655).A)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},5175:(e,t,s)=>{s.d(t,{A:()=>a});var r=s(9950);const a=()=>{const[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)(!1),[n,l]=(0,r.useState)(null),c=(0,r.useCallback)(async()=>{a(!0),l(null);try{{const e=await fetch("/api/ai/config");if(!e.ok)throw new Error("Failed to load AI configuration");const s=await e.json();t(s)}}catch(e){l(e instanceof Error?e.message:"Unknown error")}finally{a(!1)}},[]),d=(0,r.useCallback)(async e=>{a(!0),l(null);try{const r=u(e);var s;if(!r.isValid)throw new Error(`Configuration validation failed: ${null===(s=r.errors[0])||void 0===s?void 0:s.message}`);if(!(await fetch("/api/ai/config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw new Error("Failed to save AI configuration");t(e)}catch(r){throw l(r instanceof Error?r.message:"Unknown error"),r}finally{a(!1)}},[]),u=(0,r.useCallback)(e=>{var t;const s=[],r=[];if(e.general||s.push({field:"general",message:"General configuration is required",severity:"error",code:"MISSING_GENERAL_CONFIG"}),e.providers&&0!==Object.keys(e.providers).length||r.push({field:"providers",message:"No AI providers configured",impact:"high",recommendation:"Configure at least one AI provider"}),null!==(t=e.general)&&void 0!==t&&t.costLimits){const{dailyLimit:t,monthlyLimit:s}=e.general.costLimits;30*t>s&&r.push({field:"costLimits",message:"Daily limit may exceed monthly limit",impact:"medium",recommendation:"Adjust daily or monthly limits"})}return e.models&&0!==e.models.length||s.push({field:"models",message:"At least one AI model must be configured",severity:"error",code:"NO_MODELS_CONFIGURED"}),{isValid:0===s.length,errors:s,warnings:r,suggestions:[]}},[]),h=(0,r.useCallback)(()=>{const e=o();t(e)},[]),p=(0,r.useCallback)(async()=>{if(!e)throw new Error("No configuration to export");const t={metadata:{exportedAt:(new Date).toISOString(),version:e.version,exportedBy:"current-user",description:"AI Configuration Export"},config:e,checksum:i(e)};return JSON.stringify(t,null,2)},[e]),m=(0,r.useCallback)(async e=>{try{const r=JSON.parse(e);if(!r.config||!r.metadata)throw new Error("Invalid configuration file format");const a=i(r.config);if(r.checksum!==a)throw new Error("Configuration file integrity check failed");const o=u(r.config);var s;if(!o.isValid)throw new Error(`Invalid configuration: ${null===(s=o.errors[0])||void 0===s?void 0:s.message}`);t(r.config)}catch(r){throw l(r instanceof Error?r.message:"Import failed"),r}},[u]),_=(0,r.useCallback)(t=>null===e||void 0===e?void 0:e.models.find(e=>e.id===t),[e]),g=(0,r.useCallback)(t=>null===e||void 0===e?void 0:e.providers[t],[e]),E=(0,r.useCallback)((s,r)=>{if(!e)return;const a={...e,general:{...e.general,defaultModels:{...e.general.defaultModels,[s]:r}}};t(a)},[e]),A=(0,r.useCallback)(async()=>{const e=await fetch("/api/ai/usage-statistics");if(!e.ok)throw new Error("Failed to load usage statistics");return e.json()},[]),y=(0,r.useCallback)(async e=>{try{0;return(await fetch(`/api/ai/test-connection/${e}`,{method:"POST"})).ok}catch{return!1}},[]);return(0,r.useEffect)(()=>{c()},[c]),{config:e,isLoading:s,error:n,loadConfig:c,saveConfig:d,validateConfig:u,resetToDefaults:h,exportConfig:p,importConfig:m,getModelById:_,getProviderSettings:g,updateModelConfig:E,getUsageStatistics:A,testConnection:y}};function i(e){const t=JSON.stringify(e);let s=0;for(let r=0;r<t.length;r++){s=(s<<5)-s+t.charCodeAt(r),s&=s}return Math.abs(s).toString(16)}function o(){return{general:{defaultModels:{textAnalysis:{modelId:"gpt-4-turbo",temperature:.3,maxTokens:4e3,timeout:30,retries:2,fallbackModels:["claude-3-sonnet"]},dataExtraction:{modelId:"claude-3-sonnet",temperature:.1,maxTokens:8e3,timeout:45,retries:3,fallbackModels:["gpt-4-turbo"]},reportGeneration:{modelId:"gpt-4-turbo",temperature:.7,maxTokens:8e3,timeout:60,retries:2,fallbackModels:["claude-3-sonnet"]},webSearch:{modelId:"gemini-pro",temperature:.2,maxTokens:2e3,timeout:20,retries:1,fallbackModels:["gpt-3.5-turbo"]}},moduleOverrides:new Map,costLimits:{dailyLimit:100,monthlyLimit:2e3,perRequestLimit:5,warningThresholds:{daily:80,monthly:1800},alertsEnabled:!0,autoStopOnLimit:!1,budgetAllocation:{"kp-analyzer":40,"tz-generator":25,"project-evaluation":20,"marketing-planner":10,"knowledge-base":5}},performanceMode:"balanced"},providers:{openai:{apiKey:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_API_URL:"http://46.149.71.162:8000",REACT_APP_API_BASE_URL:"http://46.149.71.162:8000/api",REACT_APP_WS_URL:"ws://46.149.71.162:8000/ws",REACT_APP_ENVIRONMENT:"development",REACT_APP_USE_REAL_API:"true"}.REACT_APP_OPENAI_API_KEY||"",timeout:30,rateLimits:{requestsPerMinute:3500,tokensPerMinute:4e4,requestsPerDay:1e4},priority:1,enabled:!0},anthropic:{apiKey:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_API_URL:"http://46.149.71.162:8000",REACT_APP_API_BASE_URL:"http://46.149.71.162:8000/api",REACT_APP_WS_URL:"ws://46.149.71.162:8000/ws",REACT_APP_ENVIRONMENT:"development",REACT_APP_USE_REAL_API:"true"}.REACT_APP_ANTHROPIC_API_KEY||"",timeout:30,rateLimits:{requestsPerMinute:1e3,tokensPerMinute:2e4,requestsPerDay:5e3},priority:2,enabled:!0},google:{apiKey:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_API_URL:"http://46.149.71.162:8000",REACT_APP_API_BASE_URL:"http://46.149.71.162:8000/api",REACT_APP_WS_URL:"ws://46.149.71.162:8000/ws",REACT_APP_ENVIRONMENT:"development",REACT_APP_USE_REAL_API:"true"}.REACT_APP_GOOGLE_API_KEY||"",timeout:20,rateLimits:{requestsPerMinute:500,tokensPerMinute:1e4,requestsPerDay:2e3},priority:3,enabled:!0}},models:[],prompts:[],performance:{mode:"balanced",description:"\u041e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0431\u0430\u043b\u0430\u043d\u0441 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \u0438 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438",settings:{preferredProviders:["openai","anthropic"],timeoutMultiplier:1,retryCount:2,cacheEnabled:!0,parallelProcessing:!0,modelSelectionStrategy:"balanced"}},cache:{enabled:!0,ttl:3600,maxSize:100,strategy:"lru",keyGenerationStrategy:"hash",invalidationRules:{onModelChange:!0,onPromptChange:!0,onConfigChange:!1}},monitoring:{enabled:!0,alertChannels:[],thresholds:{responseTime:30,errorRate:5,costPerHour:10,tokenUsageRate:1e3},reportingInterval:60,retentionPeriod:30},apiKeys:[],experimental:{multiModelEnsemble:!1,adaptiveTimeout:!1,intelligentRetry:!0,contextAwarePrompting:!1,dynamicModelSelection:!1,crossProviderFallback:!0,realTimeOptimization:!1},lastUpdated:(new Date).toISOString(),version:"1.0.0"}}},6274:(e,t,s)=>{s.d(t,{A:()=>r});const r=(0,s(9655).A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},9325:(e,t,s)=>{s.d(t,{S2:()=>a});const r={STREAMLIT_URL:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_API_URL:"http://46.149.71.162:8000",REACT_APP_API_BASE_URL:"http://46.149.71.162:8000/api",REACT_APP_WS_URL:"ws://46.149.71.162:8000/ws",REACT_APP_ENVIRONMENT:"development",REACT_APP_USE_REAL_API:"true"}.REACT_APP_STREAMLIT_URL||"https://your-streamlit-domain.com",BACKEND_API_URL:"http://46.149.71.162:8000",AUTH_SERVICE_URL:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_API_URL:"http://46.149.71.162:8000",REACT_APP_API_BASE_URL:"http://46.149.71.162:8000/api",REACT_APP_WS_URL:"ws://46.149.71.162:8000/ws",REACT_APP_ENVIRONMENT:"development",REACT_APP_USE_REAL_API:"true"}.REACT_APP_AUTH_API_URL||"https://your-auth-domain.com",SOCKET_URL:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_API_URL:"http://46.149.71.162:8000",REACT_APP_API_BASE_URL:"http://46.149.71.162:8000/api",REACT_APP_WS_URL:"ws://46.149.71.162:8000/ws",REACT_APP_ENVIRONMENT:"development",REACT_APP_USE_REAL_API:"true"}.REACT_APP_SOCKET_URL||"wss://your-websocket-domain.com",AUTH_ENDPOINTS:{LOGIN:"/api/auth/login",REGISTER:"/api/auth/register",LOGOUT:"/api/auth/logout",REFRESH:"/api/auth/refresh"},STORAGE_KEYS:{USER_DATA:"devassist_user",AUTH_TOKEN:"devassist_token",REFRESH_TOKEN:"devassist_refresh_token"},IS_DEVELOPMENT:!1,PORTS:{REACT_APP:3e3,STREAMLIT_APP:8501,BACKEND_API:8e3,AUTH_SERVICE:8001,LLM_SERVICE:8002,DOCUMENTS_SERVICE:8003,DASHBOARD_SERVICE:8004}},a=()=>r.BACKEND_API_URL}}]);